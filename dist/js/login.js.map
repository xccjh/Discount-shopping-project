{"version":3,"sources":["login.js"],"names":["$","init","eventList","on","username_text","val","trim","password_text","checkPhone","mui","toast","length","post","username","password","result","console","log","meta","status","sessionStorage","setItem","JSON","stringify","data","pageurl","getItem","setTimeout","location","href","msg","phone","test"],"mappings":";;AAAAA,CAAC,CAAC,YAAY;AACZ;;;;;;;;;;;;;AAaAC,EAAAA,IAAI;;AACJ,WAASA,IAAT,GAAgB;AACdC,IAAAA,SAAS;AACV;;AAED,WAASA,SAAT,GAAqB;AACnB;AACAF,IAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBG,EAAhB,CAAmB,KAAnB,EAAyB,YAAY;AACjC;;;AAGA,UAAIC,aAAa,GAACJ,CAAC,CAAC,wBAAD,CAAD,CAA4BK,GAA5B,GAAkCC,IAAlC,EAAlB;AACA,UAAIC,aAAa,GAACP,CAAC,CAAC,wBAAD,CAAD,CAA4BK,GAA5B,GAAkCC,IAAlC,EAAlB,CALiC,CAOjC;;AACA,UAAG,CAACE,UAAU,CAACJ,aAAD,CAAd,EAA8B;AAC5B;AACAK,QAAAA,GAAG,CAACC,KAAJ,CAAU,OAAV;AACA;AACD;;AAED,UAAGH,aAAa,CAACI,MAAd,GAAqB,CAAxB,EAA0B;AACxB;AACAF,QAAAA,GAAG,CAACC,KAAJ,CAAU,OAAV;AACA;AACD,OAlBgC,CAoBjC;AAEA;;;AACAV,MAAAA,CAAC,CAACY,IAAF,CAAO,6CAAP,EAAqD;AACnDC,QAAAA,QAAQ,EAACT,aAD0C;AAEnDU,QAAAA,QAAQ,EAACP;AAF0C,OAArD,EAGE,UAAUQ,MAAV,EAAkB;AAClBC,QAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;;AACA,YAAGA,MAAM,CAACG,IAAP,CAAYC,MAAZ,IAAoB,GAAvB,EAA2B;AACzB;AACA;AACAC,UAAAA,cAAc,CAACC,OAAf,CAAuB,UAAvB,EAAkCC,IAAI,CAACC,SAAL,CAAeR,MAAM,CAACS,IAAtB,CAAlC,EAHyB,CAIzB;;AACAf,UAAAA,GAAG,CAACC,KAAJ,CAAU,MAAV,EALyB,CAMzB;;AACA,cAAIe,OAAO,GAACL,cAAc,CAACM,OAAf,CAAuB,SAAvB,CAAZ;;AAEA,cAAG,CAACD,OAAJ,EAAY;AACVA,YAAAA,OAAO,GAAC,YAAR;AACD;;AAEDE,UAAAA,UAAU,CAAC,YAAM;AAEfC,YAAAA,QAAQ,CAACC,IAAT,GAAcJ,OAAd;AACD,WAHS,EAGP,IAHO,CAAV;AAKD,SAlBD,MAkBK;AACH;AACAhB,UAAAA,GAAG,CAACC,KAAJ,CAAUK,MAAM,CAACG,IAAP,CAAYY,GAAtB;AACD;AAEF,OA5BD;AA8BH,KArDD;AAuDD,GA5EW,CA8EV;;;AACA,WAAStB,UAAT,CAAoBuB,KAApB,EAA2B;AACzB,QAAI,CAAC,kBAAkBC,IAAlB,CAAuBD,KAAvB,CAAL,EAAoC;AAClC,aAAO,KAAP;AACD,KAFD,MAEO;AACL,aAAO,IAAP;AACD;AACF;AAEJ,CAvFA,CAAD","sourcesContent":["$(function () {\r\n  /* \r\n  1 点击登录按钮\r\n    1 获取 用户名和密码\r\n    2 合法性的验证 不通过 弹窗 给提示 \r\n  2 构造参数  发送请求完成 登录\r\n    1 登录成功\r\n      1 把token存到本地存储中  既然要存数据 干脆 整个result.data 都存起来 方便后期 扩展使用\r\n      2 登录成功的提示 \r\n  3 登录成功\r\n    1 先判断有没有来源页面  存储在 sessionStorage key pageurl\r\n    2 有 就跳转到来源页面 \r\n    3 没有再跳转到 首页 index.html\r\n   */\r\n  init();\r\n  function init() {\r\n    eventList();\r\n  }\r\n\r\n  function eventList() {\r\n    // 点击 登录 按钮事件\r\n    $(\".login_btn\").on(\"tap\",function () {\r\n        /* \r\n        1 获取用户名和密码\r\n         */\r\n        let username_text=$(\"input[name='username']\").val().trim();\r\n        let password_text=$(\"input[name='password']\").val().trim();\r\n\r\n        // 1.2 验证合法性\r\n        if(!checkPhone(username_text)){\r\n          // 不通过 \r\n          mui.toast(\"手机不合法\")\r\n          return ;\r\n        }\r\n\r\n        if(password_text.length<6){\r\n          // 不通过 \r\n          mui.toast(\"密码不合法\")\r\n          return ;\r\n        }\r\n\r\n        // console.log(\"验证合法了\");\r\n\r\n        // 2 构造参数 准备执行 登录\r\n        $.post(\"http://api.pyg.ak48.xyz/api/public/v1/login\",{\r\n          username:username_text,\r\n          password:password_text\r\n        },function (result) {\r\n          console.log(result);\r\n          if(result.meta.status==200){\r\n            // 成功了\r\n            // 2.1  把数据 存入到 本地存储中  存对象的时候 要 先转成json字符串 否则会导致一个数据丢失\r\n            sessionStorage.setItem(\"userinfo\",JSON.stringify(result.data));\r\n            // 2.1.2 提示用户 延迟跳转 先 跳到 首页\r\n            mui.toast(\"登录成功\")\r\n            // 3.1 获取 来源页面\r\n            let pageurl=sessionStorage.getItem(\"pageurl\");\r\n\r\n            if(!pageurl){\r\n              pageurl=\"index.html\";\r\n            }\r\n\r\n            setTimeout(() => {\r\n              \r\n              location.href=pageurl;\r\n            }, 1000);\r\n            \r\n          }else{\r\n            // 错误\r\n            mui.toast(result.meta.msg);\r\n          }\r\n          \r\n        })\r\n      \r\n    })\r\n    \r\n  }\r\n\r\n    // 验证 手机合法性\r\n    function checkPhone(phone) {\r\n      if (!/^1[34578]\\d{9}$/.test(phone)) {\r\n        return false;\r\n      } else {\r\n        return true;\r\n      }\r\n    }\r\n  \r\n})\r\n\r\n"],"file":"login.js"}