{"version":3,"sources":["register.js"],"names":["$","init","eventList","on","mobile_txt","val","trim","checkPhone","mui","toast","post","mobile","result","meta","status","console","log","attr","time","text","timeId","setInterval","clearInterval","removeAttr","mobile_text","code_text","email_text","pwd_text","pwd2_text","gender_text","length","checkEmail","code","email","pwd","gender","setTimeout","location","href","msg","phone","test","myemail","myReg"],"mappings":"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","sourcesContent":["$(function() {\r\n  /* \r\n  1 绑定 获取验证码 tap事件\r\n    1 获取手机号码 进行合法性的验证\r\n      1 不通过 给出一个用户提示 就ok\r\n  2 构造参数 发送请求到后台   成功了\r\n    1 禁用按钮   $(this).attr(\"disabled\",\"disabled\");\r\n    2 开启定时器 倒计时 60s\r\n      1 修改按钮的文字 定时的时间\r\n    3 时间到了 \r\n      1 清除定时器\r\n      2 重新启用 按钮\r\n  3 绑定注册点击事件\r\n    1 获取一坨值 表单一些值\r\n    2 挨个验证\r\n      1 不通过弹出对话框 提示\r\n    3 构造参数 发送请求到后台 完成注册\r\n      1 注册失败  手机号码已经被注册过了 弹出一个提示 \r\n    4 注册成功\r\n      1 弹出一个提示 恭喜用户 你进坑。。\r\n      2 跳转页面 登录页面\r\n\r\n   */\r\n  init();\r\n  function init() {\r\n    eventList();\r\n  }\r\n\r\n  function eventList() {\r\n    // 绑定 获取验证码 点击事件\r\n    $(\".get_code_btn\").on(\"tap\", function() {\r\n      // attr $ 动态添加属性的方法\r\n      // disabled 标签本身就支持的 禁用属性\r\n      // $(this).attr(\"disabled\",\"disabled\");\r\n\r\n      // 1 获取手机 进行验证 属性选择器  trim 去除掉 值两边 的空格 “   15155515    ”\r\n      let mobile_txt = $(\"input[name='mobile']\")\r\n        .val()\r\n        .trim();\r\n      // 1.1 手机号码合法性判断  找工具函数 正则表达式！！！\r\n\r\n      if (!checkPhone(mobile_txt)) {\r\n        //  失败\r\n        // 1.2 弹出一个提示\r\n        mui.toast(\"手机号码错误\");\r\n\r\n        return;\r\n      }  \r\n      //  2 构造参数发送到后台\r\n      // https://zhengzhicheng.cn/api/public/v1/home/floordata\r\n      $.post(\r\n        \"http://api.pyg.ak48.xyz/api/public/v1/users/get_reg_code\",\r\n        // \"/api/public/v1/users/get_reg_code\",\r\n        {\r\n          mobile: mobile_txt\r\n        },\r\n        function(result) {\r\n          if (result.meta.status == 200) {\r\n            console.log(result);\r\n            // 成功\r\n            // 2.1 禁用按钮\r\n            $(\".get_code_btn\").attr(\"disabled\", \"disabled\");\r\n            //  2.2 开启 定时器\r\n            // 要倒计时的总时间 5s\r\n            let time = 5;\r\n            $(\".get_code_btn\").text(`${time} 秒后再获取`);\r\n            let timeId = setInterval(() => {\r\n              time--;\r\n              $(\".get_code_btn\").text(`${time} 秒后再获取`);\r\n              // 2.3 判断时间是否到期了\r\n              if (time == 0) {\r\n                // 2.3.1 清除定时器\r\n                clearInterval(timeId);\r\n                // 2.3.2 启用按钮 修改按钮文字\r\n                $(\".get_code_btn\")\r\n                  .removeAttr(\"disabled\")\r\n                  .text(\"获取验证码\");\r\n              }\r\n            }, 1000);\r\n          } else {\r\n            console.log(\"失败\", result);\r\n          }\r\n        }\r\n      );\r\n    });\r\n\r\n    // 绑定 点击注册 的按钮 事件\r\n    $(\".register_btn \").on(\"tap\", function() {\r\n      // 3.1 获取一堆值\r\n      let mobile_text = $(\"input[name='mobile']\")\r\n        .val()\r\n        .trim();\r\n      let code_text = $(\"input[name='code']\")\r\n        .val()\r\n        .trim();\r\n      let email_text = $(\"input[name='email']\")\r\n        .val()\r\n        .trim();\r\n      let pwd_text = $(\"input[name='pwd']\")\r\n        .val()\r\n        .trim();\r\n      let pwd2_text = $(\"input[name='pwd2']\")\r\n        .val()\r\n        .trim();\r\n      let gender_text = $(\"input[name='gender']:checked\")\r\n        .val()\r\n        .trim();\r\n\r\n      // 3.2 按个验证\r\n      // 验证手机号码\r\n      if (!checkPhone(mobile_text)) {\r\n        //  失败\r\n        // 1.2 弹出一个提示\r\n        mui.toast(\"手机号码错误\");\r\n\r\n        return;\r\n      }\r\n\r\n      // 验证 验证码的长度 不等于  4 就是错误\r\n      if (code_text.length != 4) {\r\n        mui.toast(\"验证码不合法\");\r\n        return;\r\n      }\r\n\r\n      // 验证邮箱的合法性\r\n      if (!checkEmail(email_text)) {\r\n        mui.toast(\"邮箱不合法\");\r\n        return;\r\n      }\r\n\r\n      // 验证密码的合法性\r\n      if (pwd_text.length < 6) {\r\n        mui.toast(\"密码格式不对\");\r\n        return;\r\n      }\r\n      // 验证 重复密码\r\n      if (pwd2_text != pwd_text) {\r\n        mui.toast(\"两次密码不一致！\");\r\n        return;\r\n      }\r\n\r\n      // 3.3 构造参数 完成注册\r\n      $.post(\r\n        \"http://api.pyg.ak48.xyz/api/public/v1/users/reg\",\r\n        {\r\n          mobile: mobile_text,\r\n          code: code_text,\r\n          email: email_text,\r\n          pwd: pwd_text,\r\n          gender: gender_text\r\n        },\r\n        function(result) {\r\n          console.log(result);\r\n          if (result.meta.status == 200) {\r\n            // 成功\r\n            mui.toast(\"注册成功\");\r\n            setTimeout(() => {\r\n              location.href = \"login.html\";\r\n            }, 1000);\r\n          } else {\r\n            mui.toast(result.meta.msg);\r\n          }\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  // 验证 手机合法性\r\n  function checkPhone(phone) {\r\n    if (!/^1[34578]\\d{9}$/.test(phone)) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  // 验证 邮箱\r\n  function checkEmail(myemail) {\r\n    var myReg = /^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\\.)+(com|cn|net|org)$/;\r\n    if (myReg.test(myemail)) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n});\r\n"],"file":"register.js"}